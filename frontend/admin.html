<script>
async function importStaffplan() {
  const f = document.getElementById("staffFile").files[0];
  if (!f) {
    alert("Bitte Staffplan auswählen");
    return;
  }

  const fd = new fd();
  fd.append("file", f);

  document.getElementById("staffMsg").textContent = "⏳ Import läuft … bitte warten";

  try {
    const r = await fetch("/api/import/staffplan", {
      method: "POST",
      body: fd
    });

    const data = await r.json();

    if (!data.ok) {
      document.getElementById("staffMsg").textContent =
        "❌ Fehler: " + (data.error || "unbekannt");
      return;
    }

    document.getElementById("staffMsg").textContent =
      "✅ Import erfolgreich\nImportierte Einträge: " + data.imported;

  } catch (e) {
    document.getElementById("staffMsg").textContent =
      "❌ Netzwerk-/Serverfehler: " + e.message;
  }
}
</script>
