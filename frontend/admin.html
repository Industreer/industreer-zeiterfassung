<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Admin – Einsatzplan</title>
</head>
<body>

<h1>Einsatzplan Import</h1>

<input type="file" id="file" accept=".xlsx">
<button onclick="importPlan()">Importieren</button>

<pre id="out"></pre>

<script>
async function importPlan() {
  const out = document.getElementById("out");
  out.textContent = "Import läuft…";

  const file = document.getElementById("file").files[0];
  if (!file) {
    alert("Datei auswählen");
    return;
  }

  const base64 = await toBase64(file);

  const res = await fetch("/api/import/staffplan", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ fileBase64: base64 })
  });

  const text = await res.text();
  try {
    const json = JSON.parse(text);
    out.textContent = JSON.stringify(json, null, 2);
  } catch {
    out.textContent = text;
  }
}

function toBase64(file) {
  return new Promise((resolve) => {
    const r = new FileReader();
    r.onload = () => resolve(r.result.split(",")[1]);
    r.readAsDataURL(file);
  });
}
</script>

</body>
</html>
